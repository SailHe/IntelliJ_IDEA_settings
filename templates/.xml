<templateSet group="自建活动模板">
  <template name="jquery" value="&lt;script type=&quot;text/javascript&quot; src=&quot;lib/jquery-3.2.1.js$reSrc$&quot;&gt;&lt;/script&gt;" description="创建jquery的库引用" toReformat="false" toShortenFQNames="true">
    <variable name="reSrc" expression="" defaultValue="" alwaysStopAt="true" />
    <context>
      <option name="HTML" value="true" />
      <option name="XML" value="true" />
    </context>
  </template>
  <template name="methodSignature" value="/**&#10; * Descriptions: $descriptions$&lt;p&gt;&#10; * &#10; * @param $Param$&#10; * @return $Return$&#10; * @author SailHe&#10; * @date $Date$ $Time$&#10; */" description="方法签名(内部)" toReformat="false" toShortenFQNames="true">
    <variable name="descriptions" expression="" defaultValue="" alwaysStopAt="true" />
    <variable name="Date" expression="date()" defaultValue="" alwaysStopAt="false" />
    <variable name="Time" expression="time()" defaultValue="" alwaysStopAt="false" />
    <variable name="Return" expression="methodReturnType()" defaultValue="" alwaysStopAt="false" />
    <variable name="Param" expression="methodParameters()" defaultValue="" alwaysStopAt="false" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
      <option name="JSP" value="true" />
    </context>
  </template>
  <template name="uniform" value="/**&#10; * Descriptions: $descriptions$&lt;p&gt;&#10; * &#10; * @author SailHe&#10; * @date $Date$ $Time$&#10; */" description="通用简易注释" toReformat="false" toShortenFQNames="true">
    <variable name="descriptions" expression="" defaultValue="" alwaysStopAt="true" />
    <variable name="Date" expression="date()" defaultValue="" alwaysStopAt="false" />
    <variable name="Time" expression="time()" defaultValue="" alwaysStopAt="false" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="nowTime" value="System.currentTimeMillis()" description="当前时间的Long值" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
    </context>
  </template>
  <template name="onClickEvent" value="$($selector$).on('click', function () {&#10;    const $currentNode = $(this);&#10;    $desc$&#10;});&#10;" description="on函数中 this 是个Dom" toReformat="false" toShortenFQNames="true">
    <variable name="selector" expression="" defaultValue="" alwaysStopAt="true" />
    <variable name="desc" expression="" defaultValue="" alwaysStopAt="true" />
    <context>
      <option name="HTML" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
      <option name="TypeScript" value="true" />
    </context>
  </template>
  <template name="selectorInput" value="'input[name=$name$]'" description="" toReformat="false" toShortenFQNames="true">
    <variable name="name" expression="" defaultValue="" alwaysStopAt="true" />
    <context>
      <option name="ECMAScript6" value="true" />
      <option name="HTML" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
      <option name="TypeScript" value="true" />
    </context>
  </template>
  <template name="lambda" value="($par$) =&gt; {&#10;    $desc$&#10;}" description="Js匿名函数" toReformat="false" toShortenFQNames="true">
    <variable name="par" expression="" defaultValue="" alwaysStopAt="true" />
    <variable name="desc" expression="" defaultValue="" alwaysStopAt="true" />
    <context>
      <option name="ECMAScript6" value="true" />
      <option name="HTML" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
      <option name="TypeScript" value="true" />
      <option name="Vue" value="true" />
    </context>
  </template>
  <template name="jpaTemplate" value="Pageable pageable = new PageRequest(pageNum, pageLength, new Sort(Sort.Direction.DESC, &quot;$sortAttribute$&quot;));&#10;List&lt;$primaryKeyType$&gt; $name$IdList = new LinkedList&lt;$primaryKeyType$&gt;();&#10;Specification&lt;$BeanType$&gt; specification = (root, criteriaQuery, criteriaBuilder) -&gt; {&#10;    //过滤条件&#10;    Predicate filter = criteriaBuilder.and(&#10;            root.get(&quot;$name$Id&quot;).in($name$IdList)&#10;            , criteriaBuilder.notEqual(root.get(&quot;$name$&quot;), &quot;idValue&quot;)&#10;    );&#10;    return filter;&#10;};&#10;Page&lt;$BeanType$&gt; page = orderRepository.findAll(specification, pageable);" description="使用jpa的分页, 查询模板" toReformat="false" toShortenFQNames="true">
    <variable name="sortAttribute" expression="" defaultValue="&quot;sorter&quot;" alwaysStopAt="false" />
    <variable name="primaryKeyType" expression="" defaultValue="&quot;PkType&quot;" alwaysStopAt="false" />
    <variable name="name" expression="" defaultValue="&quot;name&quot;" alwaysStopAt="false" />
    <variable name="BeanType" expression="" defaultValue="&quot;BeanType&quot;" alwaysStopAt="false" />
    <context>
      <option name="JAVA_CODE" value="true" />
    </context>
  </template>
  <template name="parameterPage" value="Integer pageNum, Integer pageLength" description="分页参数模板" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
    </context>
  </template>
  <template name="uniform_uh" value="/**&#10; * Descriptions: $descriptions$&lt;p&gt;&#10; * &#10; * @author Unknown||Hidden&#10; * @date $Date$ $Time$&#10; */" description="通用注释作者隐藏或未知版" toReformat="false" toShortenFQNames="true">
    <variable name="descriptions" expression="" defaultValue="" alwaysStopAt="true" />
    <variable name="Date" expression="date()" defaultValue="" alwaysStopAt="false" />
    <variable name="Time" expression="time()" defaultValue="" alwaysStopAt="false" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="edo" value="// else do nothing" description="注释用: else do nothing" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="Save" value="boolean isInsert = false;&#10;LoginUser loginUser = SecurityUtils.getLoginUser();&#10;$EntityType$ currentEntity = input.getId() == null ? null : repository.selectById(input.getId());&#10;// 若不存在也被视为新建&#10;if (currentEntity == null) {&#10;    isInsert = true;&#10;    // 书写创建时生成的字段&#10;    currentEntity = new $EntityType$();&#10;    currentEntity.setCreateId(loginUser.getUser().getId());&#10;    currentEntity.setCreateDate(new Date(System.currentTimeMillis()));&#10;    //currentEntity.setOrgId(loginUser.getUser().getOrgId()); // MybatisPlusConfig 中有配置&#10;} else {&#10;    // DNT&#10;}&#10;currentEntity.setLastUpdateDate(new Date(System.currentTimeMillis()));&#10;currentEntity.setLastUpdateId(loginUser.getUser().getId());&#10;// 书写允许更新的字段&#10;currentEntity.setField(input.getField());&#10;//  Cause: java.sql.SQLException: 无效的列类型: 1111 当使用updateById插入时&#10;int cnt = isInsert ? repository.insert(currentEntity) : repository.updateById(currentEntity);&#10;if (cnt != 1) {&#10;    throw new FriendlyException(&quot;保存失败&quot;);&#10;}&#10;// 已更新&#10;return currentEntity.getId();" description="保存逻辑(新增+更新)" toReformat="false" toShortenFQNames="true">
    <variable name="EntityType" expression="rightSideType()" defaultValue="&quot;EntityType&quot;" alwaysStopAt="true" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="toDto" value="$DtoType$ dto = new $DtoType$();&#10;// 拷贝Origin中所有与DTO匹配的字段到dto中&#10;org.springframework.beans.BeanUtils.copyProperties($inputOrEntity$, dto);" description="input / bean -&gt; dto" toReformat="false" toShortenFQNames="true">
    <variable name="DtoType" expression="methodReturnType()" defaultValue="&quot;Target&quot;" alwaysStopAt="false" />
    <variable name="inputOrEntity" expression="" defaultValue="&quot;Origin&quot;" alwaysStopAt="true" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="OPTIONS" value="@RequestMapping(method = RequestMethod.OPTIONS)" description="OPTIONS注解(一般不会用上)" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="TR" value="@Transactional(rollbackFor = Exception.class)" description="事务注解" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="NowYear" value="new Integer(LocalDate.now().getYear()).toString()" description="当前年份" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="PutStatus" value="@PutMapping(value = &quot;$api$&quot;)&#10;@ApiOperation(value = &quot;$apiName$[状态切换(审核/弃审/停用)]-OK&quot;)&#10;@ApiResponses({@ApiResponse(code = 200, message = &quot;OK&quot;, response = String.class)})&#10;@ApiImplicitParams({&#10;        @ApiImplicitParam(name = &quot;ids&quot;, value = &quot;$apiName$主键(多个逗号分割)&quot;, required = true),&#10;        @ApiImplicitParam(name = &quot;target_status&quot;, value = &quot;目标状态: 0未审核(制单) 1已审核 99停用&quot;, required = true)&#10;})&#10;public JsonData switch$Api$Status(@Validated @RequestParam(&quot;ids&quot;) Long[] ids,&#10;        @Validated @RequestParam(&quot;target_status&quot;) Long targetStatus) {&#10;    service.switch$Api$Status(ids, targetStatus);&#10;    return success();&#10;}" description="状态转换" toReformat="false" toShortenFQNames="true">
    <variable name="api" expression="" defaultValue="&quot;entity&quot;" alwaysStopAt="true" />
    <variable name="apiName" expression="" defaultValue="&quot;操作对象&quot;" alwaysStopAt="true" />
    <variable name="Api" expression="" defaultValue="&quot;Entity&quot;" alwaysStopAt="true" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="API_S" value="@ApiImplicitParams({&#10;        @ApiImplicitParam(name = &quot;ids&quot;, value = &quot;供应商id集合,逗号分隔&quot;, required = true),&#10;        @ApiImplicitParam(name = &quot;target_status&quot;, value = &quot;目标状态&quot;, required = true)&#10;})" description="参数中多个API注解" toReformat="false" toShortenFQNames="true">
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
  <template name="EPS" value="// 精度问题: 是指当两个浮点的差异在EPS以内时, 就视为相等&#10;// 也就是说这里判断的是相等 而不是 &gt;=&#10;// ($sumAmountOfGoods$.subtract(new BigDecimal(0)).compareTo($ProjectConstants$.$PRICE_EPS$) &lt; 0)&#10;&#10;// 最小金额问题(最小能保存的金额是0.01)&#10;if (input.getCostPrice()&#10;        // 四舍五入 保留BIT_CNT(2)位小数&#10;        // 或者说 使用精度0.01判断相等 然后判断大于(这里只需保证0.02&gt;0.01009通过就行) 也是可行的&#10;        // 直接与0.01进行比较 实际上0.01可能是0.01000000....99999或0.00999999&#10;        // 否则保存0.01时 结果可能是不确定的&#10;        .setScale(Constants.BIT_CNT, BigDecimal.ROUND_HALF_UP)&#10;        // 与常量=new BigDecimal(0.01)进行比较&#10;        .compareTo(Constants.MTL_MIN_PRICE) &lt; 0) {&#10;    throw new FriendlyException(&quot;金额设置过小&quot;);&#10;}" description="精度判定" toReformat="false" toShortenFQNames="true">
    <variable name="sumAmountOfGoods" expression="" defaultValue="&quot;amount&quot;" alwaysStopAt="false" />
    <variable name="ProjectConstants" expression="" defaultValue="&quot;Constants&quot;" alwaysStopAt="false" />
    <variable name="PRICE_EPS" expression="" defaultValue="&quot;EPS&quot;" alwaysStopAt="false" />
    <context>
      <option name="JAVA_CODE" value="true" />
      <option name="JAVA_SCRIPT" value="true" />
    </context>
  </template>
</templateSet>